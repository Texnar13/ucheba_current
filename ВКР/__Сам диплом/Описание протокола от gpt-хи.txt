–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ UART –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–∫–ª–∞–¥–∫–∏! –≠—Ç–æ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –∏ –≥–∏–±–∫–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –ø—Ä–æ—à–∏–≤–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤ –∫–ª–∞–≤–∏—à. –ù–∏–∂–µ —è –ø—Ä–µ–¥–ª–æ–∂—É **–ø—Ä–æ—Å—Ç–æ–π, –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –∏ –ª–µ–≥–∫–æ —Ä–µ–∞–ª–∏–∑—É–µ–º—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª**, —Å —É—á–µ—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞.

---

## üîå –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ UART-–ø—Ä–æ—Ç–æ–∫–æ–ª–∞

* **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π COM-–ø–æ—Ä—Ç (—á–µ—Ä–µ–∑ USB)
* **–°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏**: 115200 –±–æ–¥ (–∏–ª–∏ 9600‚Äì57600 –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–Ω–∏–∑–∏—Ç—å —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ)
* **–ë–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª** —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ —á–µ—Ç–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ø–∞–∫–µ—Ç–∞
* **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏**: –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ (1 –±–∞–π—Ç, XOR –≤—Å–µ—Ö –±–∞–π—Ç –¥–æ –Ω–µ–µ)

---

## üì¶ –§–æ—Ä–º–∞—Ç –ø–∞–∫–µ—Ç–∞ UART

–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```
[HEADER][CMD][LEN][DATA...][CHECKSUM]
```

| –ü–æ–ª–µ       | –†–∞–∑–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ                                   |
| ---------- | ------ | ------------------------------------------ |
| `HEADER`   | 1 –±–∞–π—Ç | –°—Ç–∞—Ä—Ç –±–∞–π—Ç: `0xAA` (–∏–ª–∏ `0x55` –¥–ª—è –æ—Ç–≤–µ—Ç–∞) |
| `CMD`      | 1 –±–∞–π—Ç | –ö–æ–º–∞–Ω–¥–∞: —Ç–∏–ø –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏       |
| `LEN`      | 1 –±–∞–π—Ç | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç –≤ –ø–æ–ª–µ DATA                |
| `DATA`     | N –±–∞–π—Ç | –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–º–∞–Ω–¥—ã)     |
| `CHECKSUM` | 1 –±–∞–π—Ç | XOR –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –±–∞–π—Ç, –≤–∫–ª—é—á–∞—è HEADER   |

---

## üìö –ö–æ–º–∞–Ω–¥—ã (CMD)

| CMD    | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ         | –û–ø–∏—Å–∞–Ω–∏–µ                                           |
| ------ | ------------------ | -------------------------------------------------- |
| `0x01` | `SET_KEYMAP_ENTRY` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∞–≤–∏—à–∏                      |
| `0x02` | `GET_KEYMAP_ENTRY` | –ó–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∞–≤–∏—à–∏                       |
| `0x03` | `SET_ACTIVE_LAYER` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —Å–ª–æ–π                           |
| `0x04` | `SAVE_TO_FLASH`    | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç—É –≤ —ç–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –ø–∞–º—è—Ç—å |
| `0x05` | `LOAD_FROM_FLASH`  | –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ä—Ç—É –∏–∑ —Ñ–ª–µ—à–∞                           |
| `0x06` | `RESET_KEYMAP`     | –°–±—Ä–æ—Å–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥–∫—É –Ω–∞ –¥–µ—Ñ–æ–ª—Ç–Ω—É—é                    |
| `0x10` | `ACK` / `NACK`     | –û—Ç–≤–µ—Ç –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: —É—Å–ø–µ—Ö / –æ—à–∏–±–∫–∞                |

---

## üß† –§–æ—Ä–º–∞—Ç `DATA` –¥–ª—è –∫–æ–º–∞–Ω–¥—ã `SET_KEYMAP_ENTRY`

```
[ROW][COL][LAYER][KEYCODE]
```

* `ROW` (1 –±–∞–π—Ç) ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ –º–∞—Ç—Ä–∏—Ü–µ
* `COL` (1 –±–∞–π—Ç) ‚Äî –Ω–æ–º–µ—Ä –∫–æ–ª–æ–Ω–∫–∏ –≤ –º–∞—Ç—Ä–∏—Ü–µ
* `LAYER` (1 –±–∞–π—Ç) ‚Äî –Ω–æ–º–µ—Ä —Å–ª–æ—è (0‚Äì4)
* `KEYCODE` (1 –±–∞–π—Ç) ‚Äî HID-–∫–æ–¥ –∫–ª–∞–≤–∏—à–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `0x04` = 'A')

–ü—Ä–∏–º–µ—Ä: `AA 01 04 02 03 00 04 CS` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª–∞–≤–∏—à—É –Ω–∞ —Å—Ç—Ä–æ–∫–µ 2, –∫–æ–ª–æ–Ω–∫–µ 3, —Å–ª–æ–π 0 ‚Üí –∫–æ–¥ `0x04` ('A').

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä –ø–∞–∫–µ—Ç–∞

```plaintext
AA 01 04 02 03 00 04 B8
```

* `AA` ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫
* `01` ‚Äî –∫–æ–º–∞–Ω–¥–∞ SET\_KEYMAP\_ENTRY
* `04` ‚Äî –¥–ª–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö
* `02` ‚Äî —Å—Ç—Ä–æ–∫–∞
* `03` ‚Äî –∫–æ–ª–æ–Ω–∫–∞
* `00` ‚Äî —Å–ª–æ–π
* `04` ‚Äî HID-–∫–æ–¥
* `B8` ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ (XOR –≤—Å–µ—Ö –±–∞–π—Ç –¥–æ –Ω–µ–µ)

---

## üí° –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ —É–¥–æ–±—Å—Ç–≤–∞

* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å—é —Ä–∞—Å–∫–ª–∞–¥–∫—É –æ–¥–Ω–∏–º –±–æ–ª—å—à–∏–º –ø–∞–∫–µ—Ç–æ–º —Å –∫–æ–º–∞–Ω–¥–æ–π `0x07 SET_FULL_KEYMAP`.
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–µ—Ä–Ω—É—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ª–æ–π –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–µ–≤ –≤ –æ—Ç–≤–µ—Ç–Ω—ã—Ö –∫–æ–º–∞–Ω–¥–∞—Ö.
* –ü—Ä–æ—Å—Ç–æ–π –º–µ—Ö–∞–Ω–∏–∑–º ACK/NACK (0x10 —Å –∫–æ–¥–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞).
* –§–ª–∞–≥–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ `SET_KEYMAP_ENTRY_EXT`, –≥–¥–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø. –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã, –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —É–¥–µ—Ä–∂–∞–Ω–∏–∏ –∏ —Ç.–¥.)

---

## üß© –ü–æ—á–µ–º—É –±–∏–Ω–∞—Ä–Ω—ã–π, –∞ –Ω–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π?

* –ë—ã—Å—Ç—Ä–µ–µ –∏ –ø—Ä–æ—â–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–º.
* –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞.
* –≠–∫–æ–Ω–æ–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫ –∏ —Å–Ω–∏–∂–∞–µ—Ç —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ.
* –õ–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∏ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è.

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É:

* –ü—Ä–∏–¥—É–º–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `SET 2 3 0 04\n`);
* –ü–æ–º–æ—á—å —Å –ø–∞—Ä—Å–µ—Ä–æ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –Ω–∞ C –∏–ª–∏ Python;
* –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ OLED-–¥–∏—Å–ø–ª–µ—è –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–º–∞–∫—Ä–æ—Å—ã, –º—É–ª—å—Ç–∏–º–µ–¥–∏–∞, –∏ —Ç.–¥.).




-----------------------

–û—Ç–ª–∏—á–Ω–æ! –¢—ã –ø–æ–¥–Ω–∏–º–∞–µ—à—å –≤–∞–∂–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –ø–ª–∞–Ω–µ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏ –∏ —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤. –ù–∏–∂–µ ‚Äî –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è, —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –∑–∞–º–µ—á–∞–Ω–∏–π:

---

## üîÅ 1. **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–ª–æ–µ–≤ —á–µ—Ä–µ–∑ –∫–ª–∞–≤–∏—à–∏**

–ù—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å `SET_KEYMAP_ENTRY`, —á—Ç–æ–±—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–µ–π—Å—Ç–≤–∏—è –∫–ª–∞–≤–∏—à–∏ –º–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–¥–∞—Ç—å **–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–ª–æ—è (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ)**, **–º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã**, **–º–∞–∫—Ä–æ—Å—ã**, –∏ —Ç.–ø.
–í–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã, –ª—É—á—à–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `KEYCODE`:

### üì¶ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø–æ–ª—è `KEYCODE`

–ò—Å–ø–æ–ª—å–∑—É–µ–º **1 –±–∞–π—Ç –∫–æ–¥ —Ç–∏–ø–∞ –¥–µ–π—Å—Ç–≤–∏—è** (`ACTION_TYPE`) –∏ **1 –±–∞–π—Ç –∞—Ä–≥—É–º–µ–Ω—Ç** (`ACTION_ARG`), –≤ —Å—É–º–º–µ **2 –±–∞–π—Ç–∞** –Ω–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∞–≤–∏—à–∏.

| Byte | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ    |
| ---- | ------------- |
| 0    | `ACTION_TYPE` |
| 1    | `ACTION_ARG`  |

### üìã `ACTION_TYPE` ‚Äî —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è –∫–ª–∞–≤–∏—à–∏

| –ó–Ω–∞—á–µ–Ω–∏–µ | –¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è     | –û–ø–∏—Å–∞–Ω–∏–µ                                                  |
| -------- | ---------------- | --------------------------------------------------------- |
| `0x00`   | `NO_ACTION`      | –ü—É—Å—Ç–æ / –Ω–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è                                      |
| `0x01`   | `HID_KEYCODE`    | –û–±—ã—á–Ω–∞—è –∫–ª–∞–≤–∏—à–∞ –ø–æ HID                                    |
| `0x02`   | `LAYER_HOLD`     | –í—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Å–ª–æ–π `ARG`, –ø–æ–∫–∞ –∑–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞ |
| `0x03`   | `LAYER_TOGGLE`   | –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Å–ª–æ–π `ARG`, –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–∞–∂–∞—Ç–∏–∏           |
| `0x04`   | `MODIFIER`       | –ù–∞–∑–Ω–∞—á–∏—Ç—å –∫–ª–∞–≤–∏—à—É-–º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä                             |
| `0x05`   | `MACRO_INDEX`    | –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∞–∫—Ä–æ—Å –∏–∑ –ø–∞–º—è—Ç–∏ —Å –∏–Ω–¥–µ–∫—Å–æ–º `ARG`               |
| `0xFF`   | `RESERVED/DEBUG` | –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ                                           |

---

## üóÑÔ∏è 2. **–•—Ä–∞–Ω–µ–Ω–∏–µ —Å–ª–æ–µ–≤ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π –≤ –ø–∞–º—è—Ç–∏ –ú–ö**

–£—á–∏—Ç—ã–≤–∞–µ–º:

* 5 —Å–ª–æ–µ–≤
* –ú–∞—Ç—Ä–∏—Ü–∞, —Å–∫–∞–∂–µ–º, –¥–æ 12√ó12 (–º–∞–∫—Å 144 –∫–ª–∞–≤–∏—à–∏)
* –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ (RAM + Flash)
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –≤ —ç–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –ø–∞–º—è—Ç—å (–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å)

### üí° –•—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `keymap[layer][row][col]`

```c
#define MAX_LAYERS 5
#define ROWS 12
#define COLS 12

typedef struct {
    uint8_t action_type;
    uint8_t action_arg;
} KeyAction;

KeyAction keymap[MAX_LAYERS][ROWS][COLS];
```

> –≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–π–º–µ—Ç:
> `5 * 12 * 12 * 2 = 1440 –±–∞–π—Ç` –≤ RAM –∏–ª–∏ Flash.

---

### üîã –≠–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è –ø–∞–º—è—Ç—å (EEPROM/Flash)

* **–°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏**
* –ò–ª–∏ —Ä–µ–∞–ª–∏–∑—É–µ–º **—Å—Ç—Ä–∞–Ω–∏—á–Ω—É—é –∑–∞–ø–∏—Å—å**: –∫–∞–∂–¥—É—é —Ä–∞—Å–∫–ª–∞–¥–∫—É ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–º –±–ª–æ–∫–æ–º
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å `SAVE_TO_FLASH` –ø–æ –∑–∞–ø—Ä–æ—Å—É (–∞ –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏!)
* –ü—Ä–æ–≤–µ—Ä–∫–∞ CRC –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

---

## ‚úÖ 3. **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ ACK/NACK**

ACK / NACK –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```
[0x55][0x10][0x01][RESULT][CHK]
```

| –ü–æ–ª–µ     | –ó–Ω–∞—á–µ–Ω–∏–µ                    |
| -------- | --------------------------- |
| `0x55`   | –û—Ç–≤–µ—Ç (–≤–º–µ—Å—Ç–æ `0xAA`)       |
| `0x10`   | –ö–æ–º–∞–Ω–¥–∞ ACK/NACK            |
| `0x01`   | –î–ª–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö: 1 –±–∞–π—Ç        |
| `RESULT` | `0x00` = OK, `0x01` = Error |
| `CHK`    | –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞           |

–ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ:

```
[0x55][0x10][LEN][RESULT][OPTIONAL...][CHK]
```

–ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –æ—à–∏–±–∫–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–¥ –æ—à–∏–±–∫–∏.

---

## üì• 4. **–ö–æ–º–∞–Ω–¥–∞ SET\_FULL\_KEYMAP**

–ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å **–≤—Å—é —Ä–∞—Å–∫–ª–∞–¥–∫—É** —Ü–µ–ª–∏–∫–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–∑ —É—Ç–∏–ª–∏—Ç—ã –Ω–∞ –ü–ö.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–∞–Ω–¥—ã:

```
[0xAA][0x07][LEN][LAYER_COUNT][ROWS][COLS][...DATA...][CHK]
```

### –ü–æ–ª–µ DATA:

* –ù–∞–±–æ—Ä `KeyAction` –ø–æ–¥—Ä—è–¥:
  `[TYPE1][ARG1][TYPE2][ARG2] ...` –≤ –ø–æ—Ä—è–¥–∫–µ:
  `[layer0][row0][col0] ‚Üí [layer0][row0][col1] ... ‚Üí [layerN][rowM][colK]`

#### –ü—Ä–∏–º–µ—Ä:

* 5 —Å–ª–æ–µ–≤, 4 —Å—Ç—Ä–æ–∫–∏, 4 –∫–æ–ª–æ–Ω–∫–∏ = 80 –∫–ª–∞–≤–∏—à
* –ö–∞–∂–¥—ã–π `KeyAction` = 2 –±–∞–π—Ç–∞
  \=> –≤—Å–µ–≥–æ `2 * 80 = 160 –±–∞–π—Ç`, –ø–ª—é—Å –∑–∞–≥–æ–ª–æ–≤–æ–∫

–ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π keymap, –æ–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç `ACK` –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª–∏–Ω—ã).

---

## üñ•Ô∏è 5. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∏—Å–ø–ª–µ—è**

–ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—É `0x20 SET_DISPLAY_CONFIG`, –≤ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–¥–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫—Ä–∞–Ω–∞:

| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –î–∏–∞–ø–∞–∑–æ–Ω           | –û–ø–∏—Å–∞–Ω–∏–µ                                      |
| ------------ | ------------------ | --------------------------------------------- |
| `brightness` | `0‚Äì255` –∏–ª–∏ `0‚Äì15` | –Ø—Ä–∫–æ—Å—Ç—å (–ª–∏–Ω–µ–π–Ω–∞—è —à–∫–∞–ª–∞)                      |
| `timeout`    | `—Å–µ–∫—É–Ω–¥—ã`          | –¢–∞–π–º–∞—É—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏                  |
| `mode`       | `enum`             | –ß—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å: –ª–æ–≥–æ—Ç–∏–ø / —Å–ª–æ–π / custom —Ç–µ–∫—Å—Ç |
| `contrast`   | `0‚Äì255`            | –ö–æ–Ω—Ç—Ä–∞—Å—Ç, –µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è                 |

**–ü—Ä–∏–º–µ—Ä—ã:**

* –Ø—Ä–∫–æ—Å—Ç—å `0x20 01 01 10 CS` ‚Äî —è—Ä–∫–æ—Å—Ç—å = 16
* –í—ã–≤–æ–¥ —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–æ—è `0x20 02 01 01 CS`

---

## üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢—ã –ø–æ–ª—É—á–∞–µ—à—å **–≥–∏–±–∫–∏–π –∏ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª**, —Å–ø–æ—Å–æ–±–Ω—ã–π:

* –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏, –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∏ —Å–ª–æ–∏
* –°–æ—Ö—Ä–∞–Ω—è—Ç—å/–∑–∞–≥—Ä—É–∂–∞—Ç—å —Ä–∞—Å–∫–ª–∞–¥–∫–∏
* –†–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∏–∑–∫–∏–º –æ–±—ä–µ–º–æ–º –ø–∞–º—è—Ç–∏
* –û–±–µ—Å–ø–µ—á–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —É—Ç–∏–ª–∏—Ç–∞–º–∏ –ü–ö

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –ø–æ–º–æ–≥—É –Ω–∞–ø–∏—Å–∞—Ç—å **—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø–∞—Ä—Å–µ—Ä–∞** –Ω–∞ C, –∞ —Ç–∞–∫–∂–µ **–¥–µ—Å–∫—Ç–æ–ø–Ω—É—é —É—Ç–∏–ª–∏—Ç—É** –Ω–∞ Python –∏–ª–∏ Rust.

–ì–æ—Ç–æ–≤ —Ä–∞–∑–≤–∏–≤–∞—Ç—å –¥–∞–ª—å—à–µ, –µ—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è –∏–¥–µ–∏ –≤—Ä–æ–¥–µ –º–∞–∫—Ä–æ—Å–æ–≤, LED-–ø–æ–¥—Å–≤–µ—Ç–∫–∏ –∏–ª–∏ MIDI/OSC-–∫–æ–Ω—Ç—Ä–æ–ª—è.





